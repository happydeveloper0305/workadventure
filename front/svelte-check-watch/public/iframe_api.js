"use strict";var Rt=Object.defineProperty,Wt=Object.defineProperties;var Nt=Object.getOwnPropertyDescriptors;var et=Object.getOwnPropertySymbols;var Lt=Object.prototype.hasOwnProperty,Ut=Object.prototype.propertyIsEnumerable;var tt=(r,e,t)=>e in r?Rt(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,u=(r,e)=>{for(var t in e||(e={}))Lt.call(e,t)&&tt(r,t,e[t]);if(et)for(var t of et(e))Ut.call(e,t)&&tt(r,t,e[t]);return r},w=(r,e)=>Wt(r,Nt(e));const rt={};function A(r){const e={typeChecker:r.typeChecker,callback:r.callback},t={[r.type]:e};return Object.assign(rt,t),r}var T;(function(r){function e(t){throw new Error}r.assertNever=e,r.arrayToEnum=t=>{const n={};for(const a of t)n[a]=a;return n},r.getValidEnumValues=t=>{const n=r.objectKeys(t).filter(o=>typeof t[t[o]]!="number"),a={};for(const o of n)a[o]=t[o];return r.objectValues(a)},r.objectValues=t=>r.objectKeys(t).map(function(n){return t[n]}),r.objectKeys=typeof Object.keys=="function"?t=>Object.keys(t):t=>{const n=[];for(const a in t)Object.prototype.hasOwnProperty.call(t,a)&&n.push(a);return n},r.find=(t,n)=>{for(const a of t)if(n(a))return a},r.isInteger=typeof Number.isInteger=="function"?t=>Number.isInteger(t):t=>typeof t=="number"&&isFinite(t)&&Math.floor(t)===t})(T||(T={}));const d=T.arrayToEnum(["invalid_type","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of"]),Vt=r=>JSON.stringify(r,null,2).replace(/"([^"]+)":/g,"$1:");class U extends Error{constructor(e){super();this.issues=[],this.format=()=>{const n={_errors:[]},a=o=>{for(const i of o.issues)if(i.code==="invalid_union")i.unionErrors.map(a);else if(i.code==="invalid_return_type")a(i.returnTypeError);else if(i.code==="invalid_arguments")a(i.argumentsError);else if(i.path.length===0)n._errors.push(i.message);else{let c=n,l=0;for(;l<i.path.length;){const h=i.path[l];if(l===i.path.length-1)c[h]=c[h]||{_errors:[]},c[h]._errors.push(i.message);else if(typeof h=="string")c[h]=c[h]||{_errors:[]};else if(typeof h=="number"){const E=[];E._errors=[],c[h]=c[h]||E}c=c[h],l++}}};return a(this),n},this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}toString(){return this.message}get message(){return JSON.stringify(this.issues,null,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},n=[];for(const a of this.issues)a.path.length>0?(t[a.path[0]]=t[a.path[0]]||[],t[a.path[0]].push(e(a))):n.push(e(a));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}U.create=r=>new U(r);const ee=(r,e)=>{let t;switch(r.code){case d.invalid_type:r.received==="undefined"?t="Required":t=`Expected ${r.expected}, received ${r.received}`;break;case d.unrecognized_keys:t=`Unrecognized key(s) in object: ${r.keys.map(n=>`'${n}'`).join(", ")}`;break;case d.invalid_union:t="Invalid input";break;case d.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${r.options.map(n=>typeof n=="string"?`'${n}'`:n).join(" | ")}`;break;case d.invalid_enum_value:t=`Invalid enum value. Expected ${r.options.map(n=>typeof n=="string"?`'${n}'`:n).join(" | ")}`;break;case d.invalid_arguments:t="Invalid function arguments";break;case d.invalid_return_type:t="Invalid function return type";break;case d.invalid_date:t="Invalid date";break;case d.invalid_string:r.validation!=="regex"?t=`Invalid ${r.validation}`:t="Invalid";break;case d.too_small:r.type==="array"?t=`Array must contain ${r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?t=`String must contain ${r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?t=`Number must be greater than ${r.inclusive?"or equal to ":""}${r.minimum}`:t="Invalid input";break;case d.too_big:r.type==="array"?t=`Array must contain ${r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?t=`String must contain ${r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?t=`Number must be less than ${r.inclusive?"or equal to ":""}${r.maximum}`:t="Invalid input";break;case d.custom:t="Invalid input";break;case d.invalid_intersection_types:t="Intersection results could not be merged";break;case d.not_multiple_of:t=`Number must be a multiple of ${r.multipleOf}`;break;default:t=e.defaultError,T.assertNever(r)}return{message:t}};let te=ee;const zt=r=>{te=r},p=T.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),V=r=>{switch(typeof r){case"undefined":return p.undefined;case"string":return p.string;case"number":return isNaN(r)?p.nan:p.number;case"boolean":return p.boolean;case"function":return p.function;case"bigint":return p.bigint;case"object":return Array.isArray(r)?p.array:r===null?p.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?p.promise:typeof Map!="undefined"&&r instanceof Map?p.map:typeof Set!="undefined"&&r instanceof Set?p.set:typeof Date!="undefined"&&r instanceof Date?p.date:p.object;default:return p.unknown}},le=r=>{const{data:e,path:t,errorMaps:n,issueData:a}=r,o=[...t,...a.path||[]],i=w(u({},a),{path:o});let c="";const l=n.filter(h=>!!h).slice().reverse();for(const h of l)c=h(i,{data:e,defaultError:c}).message;return w(u({},a),{path:o,message:a.message||c})},Dt=[];function m(r,e){const t=le({issueData:e,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,te,ee].filter(n=>!!n)});r.common.issues.push(t)}class C{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const a of t){if(a.status==="aborted")return b;a.status==="dirty"&&e.dirty(),n.push(a.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const a of t)n.push({key:await a.key,value:await a.value});return C.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const a of t){const{key:o,value:i}=a;if(o.status==="aborted"||i.status==="aborted")return b;o.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),(typeof i.value!="undefined"||a.alwaysSet)&&(n[o.value]=i.value)}return{status:e.value,value:n}}}const b=Object.freeze({status:"aborted"}),qt=r=>({status:"dirty",value:r}),S=r=>({status:"valid",value:r}),Me=r=>r.status==="aborted",Ze=r=>r.status==="dirty",de=r=>r.status==="valid",Ie=r=>typeof Promise!==void 0&&r instanceof Promise;var x;(function(r){r.errToObj=e=>typeof e=="string"?{message:e}:e||{},r.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(x||(x={}));class I{constructor(e,t,n,a){this.parent=e,this.data=t,this._path=n,this._key=a}get path(){return this._path.concat(this._key)}}const nt=(r,e)=>{if(de(e))return{success:!0,data:e.value};{if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");const t=new U(r.common.issues);return{success:!1,error:t}}};function _(r){if(!r)return{};const{errorMap:e,invalid_type_error:t,required_error:n,description:a}=r;if(e&&(t||n))throw new Error(`Can't use "invalid" or "required" in conjunction with custom error map.`);return e?{errorMap:e,description:a}:{errorMap:(i,c)=>i.code!=="invalid_type"?{message:c.defaultError}:typeof c.data=="undefined"&&n?{message:n}:r.invalid_type_error?{message:r.invalid_type_error}:{message:c.defaultError},description:a}}class g{constructor(e){this.spa=this.safeParseAsync,this.superRefine=this._refinement,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.default=this.default.bind(this),this.describe=this.describe.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return V(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:V(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new C,ctx:{common:e.parent.common,data:e.data,parsedType:V(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Ie(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const a={common:{issues:[],async:(n=t==null?void 0:t.async)!==null&&n!==void 0?n:!1,typeCache:typeof Map!="undefined"?new Map:void 0,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:V(e)},o=this._parseSync({data:e,path:a.path,parent:a});return nt(a,o)}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0,typeCache:typeof Map!="undefined"?new Map:void 0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:V(e)},a=this._parse({data:e,path:[],parent:n}),o=await(Ie(a)?a:Promise.resolve(a));return nt(n,o)}refine(e,t){const n=a=>typeof t=="string"||typeof t=="undefined"?{message:t}:typeof t=="function"?t(a):t;return this._refinement((a,o)=>{const i=e(a),c=()=>o.addIssue(u({code:d.custom},n(a)));return typeof Promise!="undefined"&&i instanceof Promise?i.then(l=>l?!0:(c(),!1)):i?!0:(c(),!1)})}refinement(e,t){return this._refinement((n,a)=>e(n)?!0:(a.addIssue(typeof t=="function"?t(n,a):t),!1))}_refinement(e){return new W({schema:this,typeName:y.ZodEffects,effect:{type:"refinement",refinement:e}})}optional(){return N.create(this)}nullable(){return Y.create(this)}nullish(){return this.optional().nullable()}array(){return O.create(this)}promise(){return G.create(this)}or(e){return re.create([this,e])}and(e){return ne.create(this,e)}transform(e){return new W({schema:this,typeName:y.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new Re({innerType:this,defaultValue:t,typeName:y.ZodDefault})}describe(e){const t=this.constructor;return new t(w(u({},this._def),{description:e}))}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Bt=/^c[^\s-]{8,}$/i,$t=/^([a-f0-9]{8}-[a-f0-9]{4}-[1-5][a-f0-9]{3}-[a-f0-9]{4}-[a-f0-9]{12}|00000000-0000-0000-0000-000000000000)$/i,Kt=/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i;class q extends g{constructor(){super(...arguments);this._regex=(e,t,n)=>this.refinement(a=>e.test(a),u({validation:t,code:d.invalid_string},x.errToObj(n))),this.nonempty=e=>this.min(1,x.errToObj(e))}_parse(e){if(this._getType(e)!==p.string){const o=this._getOrReturnCtx(e);return m(o,{code:d.invalid_type,expected:p.string,received:o.parsedType}),b}const n=new C;let a;for(const o of this._def.checks)if(o.kind==="min")e.data.length<o.value&&(a=this._getOrReturnCtx(e,a),m(a,{code:d.too_small,minimum:o.value,type:"string",inclusive:!0,message:o.message}),n.dirty());else if(o.kind==="max")e.data.length>o.value&&(a=this._getOrReturnCtx(e,a),m(a,{code:d.too_big,maximum:o.value,type:"string",inclusive:!0,message:o.message}),n.dirty());else if(o.kind==="email")Kt.test(e.data)||(a=this._getOrReturnCtx(e,a),m(a,{validation:"email",code:d.invalid_string,message:o.message}),n.dirty());else if(o.kind==="uuid")$t.test(e.data)||(a=this._getOrReturnCtx(e,a),m(a,{validation:"uuid",code:d.invalid_string,message:o.message}),n.dirty());else if(o.kind==="cuid")Bt.test(e.data)||(a=this._getOrReturnCtx(e,a),m(a,{validation:"cuid",code:d.invalid_string,message:o.message}),n.dirty());else if(o.kind==="url")try{new URL(e.data)}catch{a=this._getOrReturnCtx(e,a),m(a,{validation:"url",code:d.invalid_string,message:o.message}),n.dirty()}else o.kind==="regex"&&(o.regex.lastIndex=0,o.regex.test(e.data)||(a=this._getOrReturnCtx(e,a),m(a,{validation:"regex",code:d.invalid_string,message:o.message}),n.dirty()));return{status:n.value,value:e.data}}_addCheck(e){return new q(w(u({},this._def),{checks:[...this._def.checks,e]}))}email(e){return this._addCheck(u({kind:"email"},x.errToObj(e)))}url(e){return this._addCheck(u({kind:"url"},x.errToObj(e)))}uuid(e){return this._addCheck(u({kind:"uuid"},x.errToObj(e)))}cuid(e){return this._addCheck(u({kind:"cuid"},x.errToObj(e)))}regex(e,t){return this._addCheck(u({kind:"regex",regex:e},x.errToObj(t)))}min(e,t){return this._addCheck(u({kind:"min",value:e},x.errToObj(t)))}max(e,t){return this._addCheck(u({kind:"max",value:e},x.errToObj(t)))}length(e,t){return this.min(e,t).max(e,t)}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get minLength(){let e=-1/0;return this._def.checks.map(t=>{t.kind==="min"&&(e===null||t.value>e)&&(e=t.value)}),e}get maxLength(){let e=null;return this._def.checks.map(t=>{t.kind==="max"&&(e===null||t.value<e)&&(e=t.value)}),e}}q.create=r=>new q(u({checks:[],typeName:y.ZodString},_(r)));function Yt(r,e){const t=(r.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,a=t>n?t:n,o=parseInt(r.toFixed(a).replace(".","")),i=parseInt(e.toFixed(a).replace(".",""));return o%i/Math.pow(10,a)}class B extends g{constructor(){super(...arguments);this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._getType(e)!==p.number){const o=this._getOrReturnCtx(e);return m(o,{code:d.invalid_type,expected:p.number,received:o.parsedType}),b}let n;const a=new C;for(const o of this._def.checks)o.kind==="int"?T.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),m(n,{code:d.invalid_type,expected:"integer",received:"float",message:o.message}),a.dirty()):o.kind==="min"?(o.inclusive?e.data<o.value:e.data<=o.value)&&(n=this._getOrReturnCtx(e,n),m(n,{code:d.too_small,minimum:o.value,type:"number",inclusive:o.inclusive,message:o.message}),a.dirty()):o.kind==="max"?(o.inclusive?e.data>o.value:e.data>=o.value)&&(n=this._getOrReturnCtx(e,n),m(n,{code:d.too_big,maximum:o.value,type:"number",inclusive:o.inclusive,message:o.message}),a.dirty()):o.kind==="multipleOf"?Yt(e.data,o.value)!==0&&(n=this._getOrReturnCtx(e,n),m(n,{code:d.not_multiple_of,multipleOf:o.value,message:o.message}),a.dirty()):T.assertNever(o);return{status:a.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,x.toString(t))}gt(e,t){return this.setLimit("min",e,!1,x.toString(t))}lte(e,t){return this.setLimit("max",e,!0,x.toString(t))}lt(e,t){return this.setLimit("max",e,!1,x.toString(t))}setLimit(e,t,n,a){return new B(w(u({},this._def),{checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:x.toString(a)}]}))}_addCheck(e){return new B(w(u({},this._def),{checks:[...this._def.checks,e]}))}int(e){return this._addCheck({kind:"int",message:x.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:x.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:x.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:x.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:x.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:x.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int")}}B.create=r=>new B(u({checks:[],typeName:y.ZodNumber},_(r)));class pe extends g{_parse(e){if(this._getType(e)!==p.bigint){const n=this._getOrReturnCtx(e);return m(n,{code:d.invalid_type,expected:p.bigint,received:n.parsedType}),b}return S(e.data)}}pe.create=r=>new pe(u({typeName:y.ZodBigInt},_(r)));class he extends g{_parse(e){if(this._getType(e)!==p.boolean){const n=this._getOrReturnCtx(e);return m(n,{code:d.invalid_type,expected:p.boolean,received:n.parsedType}),b}return S(e.data)}}he.create=r=>new he(u({typeName:y.ZodBoolean},_(r)));class fe extends g{_parse(e){if(this._getType(e)!==p.date){const n=this._getOrReturnCtx(e);return m(n,{code:d.invalid_type,expected:p.date,received:n.parsedType}),b}if(isNaN(e.data.getTime())){const n=this._getOrReturnCtx(e);return m(n,{code:d.invalid_date}),b}return{status:"valid",value:new Date(e.data.getTime())}}}fe.create=r=>new fe(u({typeName:y.ZodDate},_(r)));class me extends g{_parse(e){if(this._getType(e)!==p.undefined){const n=this._getOrReturnCtx(e);return m(n,{code:d.invalid_type,expected:p.undefined,received:n.parsedType}),b}return S(e.data)}}me.create=r=>new me(u({typeName:y.ZodUndefined},_(r)));class ye extends g{_parse(e){if(this._getType(e)!==p.null){const n=this._getOrReturnCtx(e);return m(n,{code:d.invalid_type,expected:p.null,received:n.parsedType}),b}return S(e.data)}}ye.create=r=>new ye(u({typeName:y.ZodNull},_(r)));class H extends g{constructor(){super(...arguments);this._any=!0}_parse(e){return S(e.data)}}H.create=r=>new H(u({typeName:y.ZodAny},_(r)));class z extends g{constructor(){super(...arguments);this._unknown=!0}_parse(e){return S(e.data)}}z.create=r=>new z(u({typeName:y.ZodUnknown},_(r)));class D extends g{_parse(e){const t=this._getOrReturnCtx(e);return m(t,{code:d.invalid_type,expected:p.never,received:t.parsedType}),b}}D.create=r=>new D(u({typeName:y.ZodNever},_(r)));class be extends g{_parse(e){if(this._getType(e)!==p.undefined){const n=this._getOrReturnCtx(e);return m(n,{code:d.invalid_type,expected:p.void,received:n.parsedType}),b}return S(e.data)}}be.create=r=>new be(u({typeName:y.ZodVoid},_(r)));class O extends g{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),a=this._def;if(t.parsedType!==p.array)return m(t,{code:d.invalid_type,expected:p.array,received:t.parsedType}),b;if(a.minLength!==null&&t.data.length<a.minLength.value&&(m(t,{code:d.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,message:a.minLength.message}),n.dirty()),a.maxLength!==null&&t.data.length>a.maxLength.value&&(m(t,{code:d.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,message:a.maxLength.message}),n.dirty()),t.common.async)return Promise.all(t.data.map((i,c)=>a.type._parseAsync(new I(t,i,t.path,c)))).then(i=>C.mergeArray(n,i));const o=t.data.map((i,c)=>a.type._parseSync(new I(t,i,t.path,c)));return C.mergeArray(n,o)}get element(){return this._def.type}min(e,t){return new O(w(u({},this._def),{minLength:{value:e,message:x.toString(t)}}))}max(e,t){return new O(w(u({},this._def),{maxLength:{value:e,message:x.toString(t)}}))}length(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}O.create=(r,e)=>new O(u({type:r,minLength:null,maxLength:null,typeName:y.ZodArray},_(e)));var ve;(function(r){r.mergeShapes=(e,t)=>u(u({},e),t)})(ve||(ve={}));const st=r=>e=>new k(w(u({},r),{shape:()=>u(u({},r.shape()),e)}));function J(r){if(r instanceof k){const e={};for(const t in r.shape){const n=r.shape[t];e[t]=N.create(J(n))}return new k(w(u({},r._def),{shape:()=>e}))}else return r instanceof O?O.create(J(r.element)):r instanceof N?N.create(J(r.unwrap())):r instanceof Y?Y.create(J(r.unwrap())):r instanceof R?R.create(r.items.map(e=>J(e))):r}class k extends g{constructor(){super(...arguments);this._cached=null,this.nonstrict=this.passthrough,this.augment=st(this._def),this.extend=st(this._def)}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=T.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==p.object){const f=this._getOrReturnCtx(e);return m(f,{code:d.invalid_type,expected:p.object,received:f.parsedType}),b}const{status:n,ctx:a}=this._processInputParams(e),{shape:o,keys:i}=this._getCached(),l=T.objectKeys(a.data).filter(f=>!i.includes(f)),h=[];for(const f of i){const E=o[f],j=a.data[f];h.push({key:{status:"valid",value:f},value:E._parse(new I(a,j,a.path,f)),alwaysSet:f in a.data})}if(this._def.catchall instanceof D){const f=this._def.unknownKeys;if(f==="passthrough")for(const E of l)h.push({key:{status:"valid",value:E},value:{status:"valid",value:a.data[E]}});else if(f==="strict")l.length>0&&(m(a,{code:d.unrecognized_keys,keys:l}),n.dirty());else if(f!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const f=this._def.catchall;for(const E of l){const j=a.data[E];h.push({key:{status:"valid",value:E},value:f._parse(new I(a,j,a.path,E)),alwaysSet:E in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const f=[];for(const E of h){const j=await E.key;f.push({key:j,value:await E.value,alwaysSet:E.alwaysSet})}return f}).then(f=>C.mergeObjectSync(n,f)):C.mergeObjectSync(n,h)}get shape(){return this._def.shape()}strict(e){return x.errToObj,new k(u(w(u({},this._def),{unknownKeys:"strict"}),e!==void 0?{errorMap:(t,n)=>{var a,o,i,c;const l=(i=(o=(a=this._def).errorMap)===null||o===void 0?void 0:o.call(a,t,n).message)!==null&&i!==void 0?i:n.defaultError;return t.code==="unrecognized_keys"?{message:(c=x.errToObj(e).message)!==null&&c!==void 0?c:l}:{message:l}}}:{}))}strip(){return new k(w(u({},this._def),{unknownKeys:"strip"}))}passthrough(){return new k(w(u({},this._def),{unknownKeys:"passthrough"}))}setKey(e,t){return this.augment({[e]:t})}merge(e){return new k({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>ve.mergeShapes(this._def.shape(),e._def.shape()),typeName:y.ZodObject})}catchall(e){return new k(w(u({},this._def),{catchall:e}))}pick(e){const t={};return T.objectKeys(e).map(n=>{t[n]=this.shape[n]}),new k(w(u({},this._def),{shape:()=>t}))}omit(e){const t={};return T.objectKeys(this.shape).map(n=>{T.objectKeys(e).indexOf(n)===-1&&(t[n]=this.shape[n])}),new k(w(u({},this._def),{shape:()=>t}))}deepPartial(){return J(this)}partial(e){const t={};if(e)return T.objectKeys(this.shape).map(n=>{T.objectKeys(e).indexOf(n)===-1?t[n]=this.shape[n]:t[n]=this.shape[n].optional()}),new k(w(u({},this._def),{shape:()=>t}));for(const n in this.shape){const a=this.shape[n];t[n]=a.optional()}return new k(w(u({},this._def),{shape:()=>t}))}required(){const e={};for(const t in this.shape){let a=this.shape[t];for(;a instanceof N;)a=a._def.innerType;e[t]=a}return new k(w(u({},this._def),{shape:()=>e}))}}k.create=(r,e)=>new k(u({shape:()=>r,unknownKeys:"strip",catchall:D.create(),typeName:y.ZodObject},_(e)));k.strictCreate=(r,e)=>new k(u({shape:()=>r,unknownKeys:"strict",catchall:D.create(),typeName:y.ZodObject},_(e)));k.lazycreate=(r,e)=>new k(u({shape:r,unknownKeys:"strip",catchall:D.create(),typeName:y.ZodObject},_(e)));class re extends g{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;function a(o){for(const c of o)if(c.result.status==="valid")return c.result;for(const c of o)if(c.result.status==="dirty")return t.common.issues.push(...c.ctx.common.issues),c.result;const i=o.map(c=>new U(c.ctx.common.issues));return m(t,{code:d.invalid_union,unionErrors:i}),b}if(t.common.async)return Promise.all(n.map(async o=>{const i=w(u({},t),{common:w(u({},t.common),{issues:[]}),parent:null});return{result:await o._parseAsync({data:t.data,path:t.path,parent:i}),ctx:i}})).then(a);{let o;const i=[];for(const l of n){const h=w(u({},t),{common:w(u({},t.common),{issues:[]}),parent:null}),f=l._parseSync({data:t.data,path:t.path,parent:h});if(f.status==="valid")return f;f.status==="dirty"&&!o&&(o={result:f,ctx:h}),h.common.issues.length&&i.push(h.common.issues)}if(o)return t.common.issues.push(...o.ctx.common.issues),o.result;const c=i.map(l=>new U(l));return m(t,{code:d.invalid_union,unionErrors:c}),b}}get options(){return this._def.options}}re.create=(r,e)=>new re(u({options:r,typeName:y.ZodUnion},_(e)));class ge extends g{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==p.object)return m(t,{code:d.invalid_type,expected:p.object,received:t.parsedType}),b;const n=this.discriminator,a=t.data[n],o=this.options.get(a);return o?t.common.async?o._parseAsync({data:t.data,path:t.path,parent:t}):o._parseSync({data:t.data,path:t.path,parent:t}):(m(t,{code:d.invalid_union_discriminator,options:this.validDiscriminatorValues,path:[n]}),b)}get discriminator(){return this._def.discriminator}get validDiscriminatorValues(){return Array.from(this.options.keys())}get options(){return this._def.options}static create(e,t,n){const a=new Map;try{t.forEach(o=>{const i=o.shape[e].value;a.set(i,o)})}catch{throw new Error("The discriminator value could not be extracted from all the provided schemas")}if(a.size!==t.length)throw new Error("Some of the discriminator values are not unique");return new ge(u({typeName:y.ZodDiscriminatedUnion,discriminator:e,options:a},_(n)))}}function Oe(r,e){const t=V(r),n=V(e);if(r===e)return{valid:!0,data:r};if(t===p.object&&n===p.object){const a=T.objectKeys(e),o=T.objectKeys(r).filter(c=>a.indexOf(c)!==-1),i=u(u({},r),e);for(const c of o){const l=Oe(r[c],e[c]);if(!l.valid)return{valid:!1};i[c]=l.data}return{valid:!0,data:i}}else if(t===p.array&&n===p.array){if(r.length!==e.length)return{valid:!1};const a=[];for(let o=0;o<r.length;o++){const i=r[o],c=e[o],l=Oe(i,c);if(!l.valid)return{valid:!1};a.push(l.data)}return{valid:!0,data:a}}else return t===p.date&&n===p.date&&+r==+e?{valid:!0,data:r}:{valid:!1}}class ne extends g{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),a=(o,i)=>{if(Me(o)||Me(i))return b;const c=Oe(o.value,i.value);return c.valid?((Ze(o)||Ze(i))&&t.dirty(),{status:t.value,value:c.data}):(m(n,{code:d.invalid_intersection_types}),b)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([o,i])=>a(o,i)):a(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}ne.create=(r,e,t)=>new ne(u({left:r,right:e,typeName:y.ZodIntersection},_(t)));class R extends g{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==p.array)return m(n,{code:d.invalid_type,expected:p.array,received:n.parsedType}),b;if(n.data.length<this._def.items.length)return m(n,{code:d.too_small,minimum:this._def.items.length,inclusive:!0,type:"array"}),b;!this._def.rest&&n.data.length>this._def.items.length&&(m(n,{code:d.too_big,maximum:this._def.items.length,inclusive:!0,type:"array"}),t.dirty());const o=n.data.map((i,c)=>{const l=this._def.items[c]||this._def.rest;return l?l._parse(new I(n,i,n.path,c)):null}).filter(i=>!!i);return n.common.async?Promise.all(o).then(i=>C.mergeArray(t,i)):C.mergeArray(t,o)}get items(){return this._def.items}rest(e){return new R(w(u({},this._def),{rest:e}))}}R.create=(r,e)=>new R(u({items:r,typeName:y.ZodTuple,rest:null},_(e)));class se extends g{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==p.object)return m(n,{code:d.invalid_type,expected:p.object,received:n.parsedType}),b;const a=[],o=this._def.keyType,i=this._def.valueType;for(const c in n.data)a.push({key:o._parse(new I(n,c,n.path,c)),value:i._parse(new I(n,n.data[c],n.path,c))});return n.common.async?C.mergeObjectAsync(t,a):C.mergeObjectSync(t,a)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof g?new se(u({keyType:e,valueType:t,typeName:y.ZodRecord},_(n))):new se(u({keyType:q.create(),valueType:e,typeName:y.ZodRecord},_(t)))}}class _e extends g{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==p.map)return m(n,{code:d.invalid_type,expected:p.map,received:n.parsedType}),b;const a=this._def.keyType,o=this._def.valueType,i=[...n.data.entries()].map(([c,l],h)=>({key:a._parse(new I(n,c,n.path,[h,"key"])),value:o._parse(new I(n,l,n.path,[h,"value"]))}));if(n.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const l of i){const h=await l.key,f=await l.value;if(h.status==="aborted"||f.status==="aborted")return b;(h.status==="dirty"||f.status==="dirty")&&t.dirty(),c.set(h.value,f.value)}return{status:t.value,value:c}})}else{const c=new Map;for(const l of i){const h=l.key,f=l.value;if(h.status==="aborted"||f.status==="aborted")return b;(h.status==="dirty"||f.status==="dirty")&&t.dirty(),c.set(h.value,f.value)}return{status:t.value,value:c}}}}_e.create=(r,e,t)=>new _e(u({valueType:e,keyType:r,typeName:y.ZodMap},_(t)));class $ extends g{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==p.set)return m(n,{code:d.invalid_type,expected:p.set,received:n.parsedType}),b;const a=this._def;a.minSize!==null&&n.data.size<a.minSize.value&&(m(n,{code:d.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,message:a.minSize.message}),t.dirty()),a.maxSize!==null&&n.data.size>a.maxSize.value&&(m(n,{code:d.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,message:a.maxSize.message}),t.dirty());const o=this._def.valueType;function i(l){const h=new Set;for(const f of l){if(f.status==="aborted")return b;f.status==="dirty"&&t.dirty(),h.add(f.value)}return{status:t.value,value:h}}const c=[...n.data.values()].map((l,h)=>o._parse(new I(n,l,n.path,h)));return n.common.async?Promise.all(c).then(l=>i(l)):i(c)}min(e,t){return new $(w(u({},this._def),{minSize:{value:e,message:x.toString(t)}}))}max(e,t){return new $(w(u({},this._def),{maxSize:{value:e,message:x.toString(t)}}))}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}$.create=(r,e)=>new $(u({valueType:r,minSize:null,maxSize:null,typeName:y.ZodSet},_(e)));class K extends g{constructor(){super(...arguments);this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==p.function)return m(t,{code:d.invalid_type,expected:p.function,received:t.parsedType}),b;function n(c,l){return le({data:c,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,te,ee].filter(h=>!!h),issueData:{code:d.invalid_arguments,argumentsError:l}})}function a(c,l){return le({data:c,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,te,ee].filter(h=>!!h),issueData:{code:d.invalid_return_type,returnTypeError:l}})}const o={errorMap:t.common.contextualErrorMap},i=t.data;return this._def.returns instanceof G?S(async(...c)=>{const l=new U([]),h=await this._def.args.parseAsync(c,o).catch(j=>{throw l.addIssue(n(c,j)),l}),f=await i(...h);return await this._def.returns._def.type.parseAsync(f,o).catch(j=>{throw l.addIssue(a(f,j)),l})}):S((...c)=>{const l=this._def.args.safeParse(c,o);if(!l.success)throw new U([n(c,l.error)]);const h=i(...l.data),f=this._def.returns.safeParse(h,o);if(!f.success)throw new U([a(h,f.error)]);return f.data})}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new K(w(u({},this._def),{args:R.create(e).rest(z.create())}))}returns(e){return new K(w(u({},this._def),{returns:e}))}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}}K.create=(r,e,t)=>new K(u({args:r?r.rest(z.create()):R.create([]).rest(z.create()),returns:e||z.create(),typeName:y.ZodFunction},_(t)));class we extends g{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}we.create=(r,e)=>new we(u({getter:r,typeName:y.ZodLazy},_(e)));class xe extends g{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return m(t,{code:d.invalid_type,expected:V(this._def.value),received:t.parsedType}),b}return{status:"valid",value:e.data}}get value(){return this._def.value}}xe.create=(r,e)=>new xe(u({value:r,typeName:y.ZodLiteral},_(e)));function Ht(r){return new ke({values:r,typeName:y.ZodEnum})}class ke extends g{_parse(e){if(this._def.values.indexOf(e.data)===-1){const t=this._getOrReturnCtx(e);return m(t,{code:d.invalid_enum_value,options:this._def.values}),b}return S(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}}ke.create=Ht;class Ee extends g{_parse(e){const t=T.getValidEnumValues(this._def.values);if(t.indexOf(e.data)===-1){const n=this._getOrReturnCtx(e);return m(n,{code:d.invalid_enum_value,options:T.objectValues(t)}),b}return S(e.data)}get enum(){return this._def.values}}Ee.create=(r,e)=>new Ee(u({values:r,typeName:y.ZodNativeEnum},_(e)));class G extends g{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==p.promise&&t.common.async===!1)return m(t,{code:d.invalid_type,expected:p.promise,received:t.parsedType}),b;const n=t.parsedType===p.promise?t.data:Promise.resolve(t.data);return S(n.then(a=>this._def.type.parseAsync(a,{path:t.path,errorMap:t.common.contextualErrorMap})))}}G.create=(r,e)=>new G(u({type:r,typeName:y.ZodPromise},_(e)));class W extends g{innerType(){return this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),a=this._def.effect||null;if(a.type==="preprocess"){const o=a.transform(n.data);return n.common.async?Promise.resolve(o).then(i=>this._def.schema._parseAsync({data:i,path:n.path,parent:n})):this._def.schema._parseSync({data:o,path:n.path,parent:n})}if(a.type==="refinement"){const o={addIssue:c=>{m(n,c),c.fatal?t.abort():t.dirty()},get path(){return n.path}};o.addIssue=o.addIssue.bind(o);const i=c=>{const l=a.refinement(c,o);if(n.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(n.common.async===!1){const c=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return c.status==="aborted"?b:(c.status==="dirty"&&t.dirty(),i(c.value),{status:t.value,value:c.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(c=>c.status==="aborted"?b:(c.status==="dirty"&&t.dirty(),i(c.value).then(()=>({status:t.value,value:c.value}))))}if(a.type==="transform")if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!de(o))return o;const i=a.transform(o.value);if(i instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return S(i)}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>de(o)?Promise.resolve(a.transform(o.value)).then(S):o);T.assertNever(a)}}W.create=(r,e,t)=>new W(u({schema:r,typeName:y.ZodEffects,effect:e},_(t)));W.createWithPreprocess=(r,e,t)=>new W(u({schema:e,effect:{type:"preprocess",transform:r},typeName:y.ZodEffects},_(t)));class N extends g{_parse(e){return this._getType(e)===p.undefined?S(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}N.create=(r,e)=>new N(u({innerType:r,typeName:y.ZodOptional},_(e)));class Y extends g{_parse(e){return this._getType(e)===p.null?S(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Y.create=(r,e)=>new Y(u({innerType:r,typeName:y.ZodNullable},_(e)));class Re extends g{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===p.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Re.create=(r,e)=>new N(u({innerType:r,typeName:y.ZodOptional},_(e)));class Te extends g{_parse(e){if(this._getType(e)!==p.nan){const n=this._getOrReturnCtx(e);return m(n,{code:d.invalid_type,expected:p.nan,received:n.parsedType}),b}return{status:"valid",value:e.data}}}Te.create=r=>new Te(u({typeName:y.ZodNaN},_(r)));const at=(r,e)=>r?H.create().refine(r,e):H.create(),Jt={object:k.lazycreate};var y;(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodPromise="ZodPromise"})(y||(y={}));const Gt=(r,e={message:`Input not instance of ${r.name}`})=>at(t=>t instanceof r,e),ot=q.create,it=B.create,Xt=Te.create,Qt=pe.create,ct=he.create,Ft=fe.create,er=me.create,tr=ye.create,rr=H.create,nr=z.create,sr=D.create,ar=be.create,or=O.create,ir=k.create,cr=k.strictCreate,ur=re.create,lr=ge.create,dr=ne.create,pr=R.create,hr=se.create,fr=_e.create,mr=$.create,yr=K.create,br=we.create,vr=xe.create,gr=ke.create,_r=Ee.create,wr=G.create,ut=W.create,xr=N.create,kr=Y.create,Er=W.createWithPreprocess,Tr=()=>ot().optional(),Sr=()=>it().optional(),Pr=()=>ct().optional();var s=Object.freeze({__proto__:null,ZodParsedType:p,getParsedType:V,makeIssue:le,EMPTY_PATH:Dt,addIssueToContext:m,ParseStatus:C,INVALID:b,DIRTY:qt,OK:S,isAborted:Me,isDirty:Ze,isValid:de,isAsync:Ie,ZodType:g,ZodString:q,ZodNumber:B,ZodBigInt:pe,ZodBoolean:he,ZodDate:fe,ZodUndefined:me,ZodNull:ye,ZodAny:H,ZodUnknown:z,ZodNever:D,ZodVoid:be,ZodArray:O,get objectUtil(){return ve},ZodObject:k,ZodUnion:re,ZodDiscriminatedUnion:ge,ZodIntersection:ne,ZodTuple:R,ZodRecord:se,ZodMap:_e,ZodSet:$,ZodFunction:K,ZodLazy:we,ZodLiteral:xe,ZodEnum:ke,ZodNativeEnum:Ee,ZodPromise:G,ZodEffects:W,ZodTransformer:W,ZodOptional:N,ZodNullable:Y,ZodDefault:Re,ZodNaN:Te,custom:at,Schema:g,ZodSchema:g,late:Jt,get ZodFirstPartyTypeKind(){return y},any:rr,array:or,bigint:Qt,boolean:ct,date:Ft,discriminatedUnion:lr,effect:ut,enum:gr,function:yr,instanceof:Gt,intersection:dr,lazy:br,literal:vr,map:fr,nan:Xt,nativeEnum:_r,never:sr,null:tr,nullable:kr,number:it,object:ir,oboolean:Pr,onumber:Sr,optional:xr,ostring:Tr,preprocess:Er,promise:wr,record:hr,set:mr,strictObject:cr,string:ot,transformer:ut,tuple:pr,undefined:er,union:ur,unknown:nr,void:ar,ZodIssueCode:d,quotelessJson:Vt,ZodError:U,defaultErrorMap:ee,get overrideErrorMap(){return te},setErrorMap:zt});const Cr=s.object({message:s.string(),author:s.string()}),jr=s.object({popupId:s.number()}),Ar=s.object({url:s.string()}),Mr=s.object({url:s.string()}),Zr=s.object({url:s.string(),allowApi:s.optional(s.boolean()),allowPolicy:s.optional(s.string()),widthPercent:s.optional(s.number()),position:s.optional(s.number()),closable:s.optional(s.boolean()),lazy:s.optional(s.boolean())}),lt=s.object({id:s.string()}),Ir=s.object({label:s.string(),className:s.optional(s.string())}),Or=s.object({popupId:s.number(),targetObject:s.string(),message:s.string(),buttons:s.array(Ir)}),Rr=s.object({url:s.string()}),dt=s.object({name:s.string()}),Wr=s.object({layerName:s.string(),propertyName:s.string(),propertyValue:s.optional(s.union([s.string(),s.number(),s.boolean()]))}),Nr=s.object({url:s.string()}),Lr=s.object({volume:s.optional(s.number()),loop:s.optional(s.boolean()),mute:s.optional(s.boolean()),rate:s.optional(s.number()),detune:s.optional(s.number()),seek:s.optional(s.number()),delay:s.optional(s.number())}),Ur=s.object({url:s.string(),config:s.optional(Lr)}),Vr=s.object({url:s.string()}),zr=s.array(s.object({x:s.number(),y:s.number(),tile:s.union([s.number(),s.string(),s.null()]),layer:s.string()})),Dr=s.object({roomId:s.string(),mapUrl:s.string(),nickname:s.string(),language:s.optional(s.string()),uuid:s.optional(s.string()),startLayerName:s.optional(s.string()),tags:s.array(s.string()),variables:s.unknown(),playerVariables:s.unknown(),userRoomToken:s.optional(s.string())}),qr=s.object({data:s.unknown()}),We=s.object({key:s.string(),value:s.unknown(),target:s.enum(["global","player"])});s.object({type:s.enum(["setVariable"]),data:We});const Br=s.object({x:s.number(),y:s.number(),width:s.number(),height:s.number()}),$r=s.object({name:s.string(),url:s.optional(s.string()),visible:s.optional(s.boolean()),allowApi:s.optional(s.boolean()),allow:s.optional(s.string()),x:s.optional(s.number()),y:s.optional(s.number()),width:s.optional(s.number()),height:s.optional(s.number()),origin:s.optional(s.enum(["player","map"])),scale:s.optional(s.number())}),pt=s.object({name:s.string(),url:s.string(),position:Br,visible:s.optional(s.boolean()),allowApi:s.optional(s.boolean()),allow:s.optional(s.string()),origin:s.optional(s.enum(["player","map"])),scale:s.optional(s.number())}),Kr=s.object({url:s.string()}),Yr="triggerActionMessage",Hr="removeActionMessage",Jr=s.enum(["message","warning"]),Gr=s.object({message:s.string(),uuid:s.string(),type:Jr}),ht=s.object({uuid:s.string()}),Xr=s.object({name:s.string()}),Qr=s.object({allowApi:s.boolean()}),Fr=s.object({name:s.string(),iframe:s.optional(s.string()),options:Qr}),en=s.object({x:s.number(),y:s.number()}),tn=s.object({x:s.number(),y:s.number(),width:s.optional(s.number()),height:s.optional(s.number()),lock:s.boolean(),smooth:s.boolean()}),rn=s.object({smooth:s.boolean()}),nn=s.object({red:s.number(),green:s.number(),blue:s.number()}),sn=s.object({x:s.number(),y:s.number(),speed:s.optional(s.number())}),an=s.object({x:s.number(),y:s.number(),cancelled:s.boolean()}),on=s.object({id:s.number(),actionKey:s.string()}),cn=s.object({id:s.number(),actionKey:s.string()});s.union([s.object({type:s.literal("addActionsMenuKeyToRemotePlayer"),data:on}),s.object({type:s.literal("removeActionsMenuKeyFromRemotePlayer"),data:cn}),s.object({type:s.literal("loadPage"),data:Mr}),s.object({type:s.literal("chat"),data:Cr}),s.object({type:s.literal("cameraFollowPlayer"),data:rn}),s.object({type:s.literal("cameraSet"),data:tn}),s.object({type:s.literal("openPopup"),data:Or}),s.object({type:s.literal("closePopup"),data:jr}),s.object({type:s.literal("openTab"),data:Rr}),s.object({type:s.literal("goToPage"),data:Ar}),s.object({type:s.literal("disablePlayerControls"),data:s.undefined()}),s.object({type:s.literal("restorePlayerControls"),data:s.undefined()}),s.object({type:s.literal("displayBubble"),data:s.undefined()}),s.object({type:s.literal("removeBubble"),data:s.undefined()}),s.object({type:s.literal("onPlayerMove"),data:s.undefined()}),s.object({type:s.literal("onCameraUpdate"),data:s.undefined()}),s.object({type:s.literal("showLayer"),data:dt}),s.object({type:s.literal("hideLayer"),data:dt}),s.object({type:s.literal("setProperty"),data:Wr}),s.object({type:s.literal("loadSound"),data:Nr}),s.object({type:s.literal("playSound"),data:Ur}),s.object({type:s.literal("stopSound"),data:Vr}),s.object({type:s.literal("registerMenu"),data:Fr}),s.object({type:s.literal("unregisterMenu"),data:Xr}),s.object({type:s.literal("setTiles"),data:zr}),s.object({type:s.literal("modifyEmbeddedWebsite"),data:$r})]);const un=r=>typeof r.type=="string";s.object({type:s.string(),data:s.unknown().optional()});s.undefined(),s.undefined(),s.undefined(),s.number(),s.undefined(),s.array(lt),s.string(),s.undefined(),s.undefined(),s.undefined(),s.undefined(),s.undefined(),s.string(),s.string(),s.undefined(),s.undefined(),s.undefined(),s.undefined(),s.undefined(),s.undefined();const ln=r=>typeof r.type=="string"&&typeof r.id=="number",dn=r=>typeof r.type=="string"&&typeof r.id=="number"&&typeof r.error=="string",pn=s.object({message:s.string()});function v(r){window.parent.postMessage(r,"*")}let Ne=0;const ae=new Map;function P(r){return new Promise((e,t)=>{window.parent.postMessage({id:Ne,query:r},"*"),ae.set(Ne,{resolve:e,reject:t}),Ne++})}class L{}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Le=function(r,e){return Le=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var a in n)n.hasOwnProperty(a)&&(t[a]=n[a])},Le(r,e)};function X(r,e){Le(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function Ue(r){return typeof r=="function"}var ft=!1,M={Promise:void 0,set useDeprecatedSynchronousErrorHandling(r){if(r){var e=new Error;""+e.stack}ft=r},get useDeprecatedSynchronousErrorHandling(){return ft}};function oe(r){setTimeout(function(){throw r},0)}var Se={closed:!0,next:function(r){},error:function(r){if(M.useDeprecatedSynchronousErrorHandling)throw r;oe(r)},complete:function(){}},hn=function(){return Array.isArray||function(r){return r&&typeof r.length=="number"}}();function fn(r){return r!==null&&typeof r=="object"}var mn=function(){function r(e){return Error.call(this),this.message=e?e.length+` errors occurred during unsubscription:
`+e.map(function(t,n){return n+1+") "+t.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=e,this}return r.prototype=Object.create(Error.prototype),r}(),Pe=mn,ie=function(){function r(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}return r.prototype.unsubscribe=function(){var e;if(!this.closed){var t=this,n=t._parentOrParents,a=t._ctorUnsubscribe,o=t._unsubscribe,i=t._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof r)n.remove(this);else if(n!==null)for(var c=0;c<n.length;++c){var l=n[c];l.remove(this)}if(Ue(o)){a&&(this._unsubscribe=void 0);try{o.call(this)}catch(E){e=E instanceof Pe?mt(E.errors):[E]}}if(hn(i))for(var c=-1,h=i.length;++c<h;){var f=i[c];if(fn(f))try{f.unsubscribe()}catch(j){e=e||[],j instanceof Pe?e=e.concat(mt(j.errors)):e.push(j)}}if(e)throw new Pe(e)}},r.prototype.add=function(e){var t=e;if(!e)return r.EMPTY;switch(typeof e){case"function":t=new r(e);case"object":if(t===this||t.closed||typeof t.unsubscribe!="function")return t;if(this.closed)return t.unsubscribe(),t;if(!(t instanceof r)){var n=t;t=new r,t._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var a=t._parentOrParents;if(a===null)t._parentOrParents=this;else if(a instanceof r){if(a===this)return t;t._parentOrParents=[a,this]}else if(a.indexOf(this)===-1)a.push(this);else return t;var o=this._subscriptions;return o===null?this._subscriptions=[t]:o.push(t),t},r.prototype.remove=function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);n!==-1&&t.splice(n,1)}},r.EMPTY=function(e){return e.closed=!0,e}(new r),r}();function mt(r){return r.reduce(function(e,t){return e.concat(t instanceof Pe?t.errors:t)},[])}var Ce=function(){return typeof Symbol=="function"?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),Q=function(r){X(e,r);function e(t,n,a){var o=r.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=Se;break;case 1:if(!t){o.destination=Se;break}if(typeof t=="object"){t instanceof e?(o.syncErrorThrowable=t.syncErrorThrowable,o.destination=t,t.add(o)):(o.syncErrorThrowable=!0,o.destination=new yt(o,t));break}default:o.syncErrorThrowable=!0,o.destination=new yt(o,t,n,a);break}return o}return e.prototype[Ce]=function(){return this},e.create=function(t,n,a){var o=new e(t,n,a);return o.syncErrorThrowable=!1,o},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,r.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},e}(ie),yt=function(r){X(e,r);function e(t,n,a,o){var i=r.call(this)||this;i._parentSubscriber=t;var c,l=i;return Ue(n)?c=n:n&&(c=n.next,a=n.error,o=n.complete,n!==Se&&(l=Object.create(n),Ue(l.unsubscribe)&&i.add(l.unsubscribe.bind(l)),l.unsubscribe=i.unsubscribe.bind(i))),i._context=l,i._next=c,i._error=a,i._complete=o,i}return e.prototype.next=function(t){if(!this.isStopped&&this._next){var n=this._parentSubscriber;!M.useDeprecatedSynchronousErrorHandling||!n.syncErrorThrowable?this.__tryOrUnsub(this._next,t):this.__tryOrSetError(n,this._next,t)&&this.unsubscribe()}},e.prototype.error=function(t){if(!this.isStopped){var n=this._parentSubscriber,a=M.useDeprecatedSynchronousErrorHandling;if(this._error)!a||!n.syncErrorThrowable?(this.__tryOrUnsub(this._error,t),this.unsubscribe()):(this.__tryOrSetError(n,this._error,t),this.unsubscribe());else if(n.syncErrorThrowable)a?(n.syncErrorValue=t,n.syncErrorThrown=!0):oe(t),this.unsubscribe();else{if(this.unsubscribe(),a)throw t;oe(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var n=this._parentSubscriber;if(this._complete){var a=function(){return t._complete.call(t._context)};!M.useDeprecatedSynchronousErrorHandling||!n.syncErrorThrowable?(this.__tryOrUnsub(a),this.unsubscribe()):(this.__tryOrSetError(n,a),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,n){try{t.call(this._context,n)}catch(a){if(this.unsubscribe(),M.useDeprecatedSynchronousErrorHandling)throw a;oe(a)}},e.prototype.__tryOrSetError=function(t,n,a){if(!M.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{n.call(this._context,a)}catch(o){return M.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=o,t.syncErrorThrown=!0,!0):(oe(o),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(Q);function yn(r){for(;r;){var e=r,t=e.closed,n=e.destination,a=e.isStopped;if(t||a)return!1;n&&n instanceof Q?r=n:r=null}return!0}function bn(r,e,t){if(r){if(r instanceof Q)return r;if(r[Ce])return r[Ce]()}return!r&&!e&&!t?new Q(Se):new Q(r,e,t)}var vn=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function gn(r){return r}function _n(r){return r.length===0?gn:r.length===1?r[0]:function(t){return r.reduce(function(n,a){return a(n)},t)}}var bt=function(){function r(e){this._isScalar=!1,e&&(this._subscribe=e)}return r.prototype.lift=function(e){var t=new r;return t.source=this,t.operator=e,t},r.prototype.subscribe=function(e,t,n){var a=this.operator,o=bn(e,t,n);if(a?o.add(a.call(o,this.source)):o.add(this.source||M.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),M.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},r.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){M.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),yn(e)?e.error(t):console.warn(t)}},r.prototype.forEach=function(e,t){var n=this;return t=vt(t),new t(function(a,o){var i;i=n.subscribe(function(c){try{e(c)}catch(l){o(l),i&&i.unsubscribe()}},o,a)})},r.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},r.prototype[vn]=function(){return this},r.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length===0?this:_n(e)(this)},r.prototype.toPromise=function(e){var t=this;return e=vt(e),new e(function(n,a){var o;t.subscribe(function(i){return o=i},function(i){return a(i)},function(){return n(o)})})},r.create=function(e){return new r(e)},r}();function vt(r){if(r||(r=M.Promise||Promise),!r)throw new Error("no Promise impl found");return r}var wn=function(){function r(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return r.prototype=Object.create(Error.prototype),r}(),ce=wn,xn=function(r){X(e,r);function e(t,n){var a=r.call(this)||this;return a.subject=t,a.subscriber=n,a.closed=!1,a}return e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,n=t.observers;if(this.subject=null,!(!n||n.length===0||t.isStopped||t.closed)){var a=n.indexOf(this.subscriber);a!==-1&&n.splice(a,1)}}},e}(ie),kn=function(r){X(e,r);function e(t){var n=r.call(this,t)||this;return n.destination=t,n}return e}(Q),Z=function(r){X(e,r);function e(){var t=r.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype[Ce]=function(){return new kn(this)},e.prototype.lift=function(t){var n=new gt(this,this);return n.operator=t,n},e.prototype.next=function(t){if(this.closed)throw new ce;if(!this.isStopped)for(var n=this.observers,a=n.length,o=n.slice(),i=0;i<a;i++)o[i].next(t)},e.prototype.error=function(t){if(this.closed)throw new ce;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var n=this.observers,a=n.length,o=n.slice(),i=0;i<a;i++)o[i].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new ce;this.isStopped=!0;for(var t=this.observers,n=t.length,a=t.slice(),o=0;o<n;o++)a[o].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(t){if(this.closed)throw new ce;return r.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){if(this.closed)throw new ce;return this.hasError?(t.error(this.thrownError),ie.EMPTY):this.isStopped?(t.complete(),ie.EMPTY):(this.observers.push(t),new xn(this,t))},e.prototype.asObservable=function(){var t=new bt;return t.source=this,t},e.create=function(t,n){return new gt(t,n)},e}(bt),gt=function(r){X(e,r);function e(t,n){var a=r.call(this)||this;return a.destination=t,a.source=n,a}return e.prototype.next=function(t){var n=this.destination;n&&n.next&&n.next(t)},e.prototype.error=function(t){var n=this.destination;n&&n.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){var n=this.source;return n?this.source.subscribe(t):ie.EMPTY},e}(Z);const _t=new Z;class En extends L{constructor(){super(...arguments);this.callbacks=[A({callback:e=>{_t.next(e.message)},type:"userInputChat",typeChecker:pn})]}sendChatMessage(e,t){v({type:"chat",data:{message:e,author:t}})}onChatMessage(e){_t.subscribe(e)}}var Ve=new En;class wt{constructor(e){this.id=e}close(){return P({type:"closeCoWebsite",data:this.id})}}class Tn extends L{constructor(){super(...arguments);this.callbacks=[]}openTab(e){v({type:"openTab",data:{url:e}})}goToPage(e){v({type:"goToPage",data:{url:e}})}goToRoom(e){v({type:"loadPage",data:{url:e}})}async openCoWebSite(e,t,n,a,o,i,c){const l=await P({type:"openCoWebsite",data:{url:e,allowApi:t,allowPolicy:n,widthPercent:a,position:o,closable:i,lazy:c}});return new wt(l.id)}async getCoWebSites(){return(await P({type:"getCoWebsites",data:void 0})).map(t=>new wt(t.id))}closeCoWebSite(){return P({type:"closeCoWebsites",data:void 0})}}var F=new Tn;class Sn extends L{constructor(){super(...arguments);this.callbacks=[]}disablePlayerControls(){v({type:"disablePlayerControls",data:void 0})}restorePlayerControls(){v({type:"restorePlayerControls",data:void 0})}}var ze=new Sn;const Pn=s.object({popupId:s.number(),buttonId:s.number()}),Cn=s.object({menuItem:s.string()});class jn{constructor(e){this.id=e}close(){v({type:"closePopup",data:{popupId:this.id}})}}function An(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)})}class Mn{constructor(e,t){var n;this.onRemove=t,this.uuid=An(),this.message=e.message,this.type=(n=e.type)!=null?n:"message",this.callback=e.callback,this.create().catch(a=>console.error(a))}async create(){await P({type:Yr,data:{message:this.message,type:this.type,uuid:this.uuid}})}async remove(){await P({type:Hr,data:{uuid:this.uuid}}),this.onRemove()}triggerCallback(){this.callback()}}class Zn{constructor(e){this.menuName=e}remove(){v({type:"unregisterMenu",data:{name:this.menuName}})}}const In=s.object({id:s.number()}),On=s.object({id:s.number(),actionName:s.string()});let ue=0;const xt=new Map,kt=new Map,Et=new Map,De=new Map,qe=new Map;class Rn{constructor(e){this.actions=new Map,this.id=e}addAction(e,t){const n=new Wn(this,e,t);return this.actions.set(e,n),v({type:"addActionsMenuKeyToRemotePlayer",data:{id:this.id,actionKey:e}}),n}callAction(e){const t=this.actions.get(e);t&&t.call()}removeAction(e){this.actions.delete(e),v({type:"removeActionsMenuKeyFromRemotePlayer",data:{id:this.id,actionKey:e}})}}class Wn{constructor(e,t,n){this.remotePlayer=e,this.key=t,this.callback=n}call(){this.callback()}remove(){this.remotePlayer.removeAction(this.key)}}class Nn extends L{constructor(){super();this.callbacks=[A({type:"buttonClickedEvent",typeChecker:Pn,callback:e=>{var a;const t=(a=kt.get(e.popupId))==null?void 0:a.get(e.buttonId),n=xt.get(e.popupId);if(n===void 0)throw new Error('Could not find popup with ID "'+e.popupId+'"');t&&t(n)}}),A({type:"menuItemClicked",typeChecker:Cn,callback:e=>{const t=De.get(e.menuItem);if(Et.get(e.menuItem)===void 0)throw new Error('Could not find menu named "'+e.menuItem+'"');t&&t(e.menuItem)}}),A({type:"messageTriggered",typeChecker:ht,callback:e=>{const t=qe.get(e.uuid);t&&t.triggerCallback()}}),A({type:"remotePlayerClickedEvent",typeChecker:In,callback:e=>{this.currentlyClickedRemotePlayer=new Rn(e.id),this._onRemotePlayerClicked.next(this.currentlyClickedRemotePlayer)}}),A({type:"actionsMenuActionClickedEvent",typeChecker:On,callback:e=>{var t;(t=this.currentlyClickedRemotePlayer)==null||t.callAction(e.actionName)}})],this._onRemotePlayerClicked=new Z,this.onRemotePlayerClicked=this._onRemotePlayerClicked.asObservable()}addActionsMenuKeyToRemotePlayer(e,t){v({type:"addActionsMenuKeyToRemotePlayer",data:{id:e,actionKey:t}})}removeActionsMenuKeyFromRemotePlayer(e,t){v({type:"removeActionsMenuKeyFromRemotePlayer",data:{id:e,actionKey:t}})}openPopup(e,t,n){ue++;const a=new jn(ue),o=new Map;kt.set(ue,o);let i=0;for(const c of n){const l=c.callback;l&&o.set(i,()=>{l(a)}),i++}return v({type:"openPopup",data:{popupId:ue,targetObject:e,message:t,buttons:n.map(c=>({label:c.label,className:c.className}))}}),xt.set(ue,a),a}registerMenuCommand(e,t){const n=new Zn(e);if(typeof t=="function")De.set(e,t),v({type:"registerMenu",data:{name:e,options:{allowApi:!1}}});else if(t.allowApi=t.allowApi===void 0?t.iframe!==void 0:t.allowApi,t.iframe!==void 0)v({type:"registerMenu",data:{name:e,iframe:t.iframe,options:{allowApi:t.allowApi}}});else if(t.callback!==void 0)De.set(e,t.callback),v({type:"registerMenu",data:{name:e,options:{allowApi:t.allowApi}}});else throw new Error("When adding a menu with WA.ui.registerMenuCommand, you must pass either an iframe or a callback");return Et.set(e,n),n}displayBubble(){v({type:"displayBubble",data:void 0})}removeBubble(){v({type:"removeBubble",data:void 0})}displayActionMessage(e){const t=new Mn(e,()=>{qe.delete(t.uuid)});return qe.set(t.uuid,t),t}}var je=new Nn;class Ln{constructor(e){this.url=e,v({type:"loadSound",data:{url:this.url}})}play(e){return v({type:"playSound",data:{url:this.url,config:e}}),this.url}stop(){return v({type:"stopSound",data:{url:this.url}}),this.url}}class Un extends L{constructor(){super(...arguments);this.callbacks=[]}loadSound(e){return new Ln(e)}}var Tt=new Un;const St=s.object({name:s.string()}),Pt=s.object({name:s.string()});class Ct{constructor(e){var t,n,a,o;this.config=e,this.name=e.name,this._url=e.url,this._visible=(t=e.visible)!=null?t:!0,this._allow=(n=e.allow)!=null?n:"",this._allowApi=(a=e.allowApi)!=null?a:!1,this._position=e.position,this.origin=e.origin,this._scale=(o=e.scale)!=null?o:1}get url(){return this._url}set url(e){this._url=e,v({type:"modifyEmbeddedWebsite",data:{name:this.name,url:this._url}})}get visible(){return this._visible}set visible(e){this._visible=e,v({type:"modifyEmbeddedWebsite",data:{name:this.name,visible:this._visible}})}get x(){return this._position.x}set x(e){this._position.x=e,v({type:"modifyEmbeddedWebsite",data:{name:this.name,x:this._position.x}})}get y(){return this._position.y}set y(e){this._position.y=e,v({type:"modifyEmbeddedWebsite",data:{name:this.name,y:this._position.y}})}get width(){return this._position.width}set width(e){this._position.width=e,v({type:"modifyEmbeddedWebsite",data:{name:this.name,width:this._position.width}})}get height(){return this._position.height}set height(e){this._position.height=e,v({type:"modifyEmbeddedWebsite",data:{name:this.name,height:this._position.height}})}get scale(){return this._scale}set scale(e){this._scale=e,v({type:"modifyEmbeddedWebsite",data:{name:this.name,scale:this._scale}})}}class Vn extends L{constructor(){super(...arguments);this.callbacks=[]}async get(e){const t=await P({type:"getEmbeddedWebsite",data:e});return new Ct(t)}create(e){return P({type:"createEmbeddedWebsite",data:e}).catch(t=>{console.error(t)}),new Ct(e)}async delete(e){return await P({type:"deleteEmbeddedWebsite",data:e})}}var zn=new Vn;const Be=new Map,$e=new Map,Ke=new Map,Ye=new Map;let He;const Dn=r=>{He=r};let Je;const qn=r=>{Je=r};class Bn extends L{constructor(){super(...arguments);this.callbacks=[A({callback:e=>{var t;(t=Be.get(e.name))==null||t.next()},type:"enterEvent",typeChecker:St}),A({type:"leaveEvent",typeChecker:St,callback:e=>{var t;(t=$e.get(e.name))==null||t.next()}}),A({type:"enterLayerEvent",typeChecker:Pt,callback:e=>{var t;(t=Ke.get(e.name))==null||t.next()}}),A({type:"leaveLayerEvent",typeChecker:Pt,callback:e=>{var t;(t=Ye.get(e.name))==null||t.next()}})]}onEnterZone(e,t){let n=Be.get(e);n===void 0&&(n=new Z,Be.set(e,n)),n.subscribe(t)}onLeaveZone(e,t){let n=$e.get(e);n===void 0&&(n=new Z,$e.set(e,n)),n.subscribe(t)}onEnterLayer(e){let t=Ke.get(e);return t===void 0&&(t=new Z,Ke.set(e,t)),t}onLeaveLayer(e){let t=Ye.get(e);return t===void 0&&(t=new Z,Ye.set(e,t)),t}showLayer(e){v({type:"showLayer",data:{name:e}})}hideLayer(e){v({type:"hideLayer",data:{name:e}})}setProperty(e,t,n){v({type:"setProperty",data:{layerName:e,propertyName:t,propertyValue:n}})}async getTiledMap(){return(await P({type:"getMapData",data:void 0})).data}setTiles(e){v({type:"setTiles",data:e})}get id(){if(He===void 0)throw new Error("Room id not initialized yet. You should call WA.room.id within a WA.onInit callback.");return He}get mapURL(){if(Je===void 0)throw new Error("mapURL is not initialized yet. You should call WA.room.mapURL within a WA.onInit callback.");return Je}async loadTileset(e){return await P({type:"loadTileset",data:{url:e}})}get website(){return zn}}var Ge=new Bn;class $n extends L{constructor(e){super();this.target=e,this.setVariableResolvers=new Z,this.variables=new Map,this.variableSubscribers=new Map,this.callbacks=[A({type:"setVariable",typeChecker:We,callback:t=>{t.target===this.target&&this.setVariableResolvers.next(t)}})],this.setVariableResolvers.subscribe(t=>{this.variables.set(t.key,t.value);const n=this.variableSubscribers.get(t.key);n!==void 0&&n.next(t.value)})}initVariables(e){for(const[t,n]of e.entries())this.variables.has(t)||this.variables.set(t,n)}saveVariable(e,t){return this.variables.set(e,t),P({type:"setVariable",data:{key:e,value:t,target:this.target}})}loadVariable(e){return this.variables.get(e)}hasVariable(e){return this.variables.has(e)}onVariableChange(e){let t=this.variableSubscribers.get(e);return t===void 0&&(t=new Z,this.variableSubscribers.set(e,t)),t.asObservable()}}function jt(r){return new Proxy(new $n(r),{get(e,t,n){return t in e?Reflect.get(e,t,n):e.loadVariable(t.toString())},set(e,t,n,a){return e.saveVariable(t.toString(),n).catch(o=>console.error(o)),!0},has(e,t){return t in e?!0:e.hasVariable(t.toString())}})}const Kn=s.object({direction:s.enum(["right","left","up","down"]),moving:s.boolean(),x:s.number(),y:s.number(),oldX:s.optional(s.number()),oldY:s.optional(s.number())}),At=new Z;let Ae;const Yn=r=>{Ae=r};let Xe;const Hn=r=>{Xe=r};let Qe;const Jn=r=>{Qe=r};let Mt,Fe;const Gn=r=>{Fe=r},Xn=r=>{Mt=r};class Qn extends L{constructor(){super(...arguments);this.state=jt("player"),this.callbacks=[A({type:"hasPlayerMoved",typeChecker:Kn,callback:e=>{At.next(e)}})]}onPlayerMove(e){At.subscribe(e),v({type:"onPlayerMove",data:void 0})}get name(){if(Ae===void 0)throw new Error("Player name not initialized yet. You should call WA.player.name within a WA.onInit callback.");return Ae}get language(){if(Xe===void 0)throw new Error("Player language not initialized yet. You should call WA.player.language within a WA.onInit callback.");return Xe}get tags(){if(Qe===void 0)throw new Error("Tags not initialized yet. You should call WA.player.tags within a WA.onInit callback.");return Qe}get id(){if(Ae===void 0)throw new Error("Player id not initialized yet. You should call WA.player.id within a WA.onInit callback.");return Mt}async getPosition(){return await P({type:"getPlayerPosition",data:void 0})}async moveTo(e,t,n){return await P({type:"movePlayerTo",data:{x:e,y:t,speed:n}})}get userRoomToken(){if(Fe===void 0)throw new Error("User-room token not initialized yet. You should call WA.player.userRoomToken within a WA.onInit callback.");return Fe}setOutlineColor(e,t,n){return P({type:"setPlayerOutline",data:{red:e,green:t,blue:n}})}removeOutlineColor(){return P({type:"removePlayerOutline",data:void 0})}}var Zt=new Qn;const Fn=s.object({x:s.number(),y:s.number(),width:s.number(),height:s.number(),zoom:s.number()}),It=new Z;class es extends L{constructor(){super(...arguments);this.callbacks=[A({type:"wasCameraUpdated",typeChecker:Fn,callback:e=>{It.next(e)}})]}set(e,t,n,a,o=!1,i=!1){v({type:"cameraSet",data:{x:e,y:t,width:n,height:a,lock:o,smooth:i}})}followPlayer(e=!1){v({type:"cameraFollowPlayer",data:{smooth:e}})}onCameraUpdate(){return v({type:"onCameraUpdate",data:void 0}),It}}var ts=new es;const Ot=jt("global"),rs=P({type:"getState",data:void 0}).then(r=>{Yn(r.nickname),Hn(r.language),Dn(r.roomId),qn(r.mapUrl),Jn(r.tags),Xn(r.uuid),Gn(r.userRoomToken),Ot.initVariables(r.variables),Zt.state.initVariables(r.playerVariables)}),ns={ui:je,nav:F,controls:ze,chat:Ve,sound:Tt,room:Ge,player:Zt,camera:ts,state:Ot,onInit(){return rs},sendChatMessage(r,e){console.warn("Method WA.sendChatMessage is deprecated. Please use WA.chat.sendChatMessage instead"),Ve.sendChatMessage(r,e)},disablePlayerControls(){console.warn("Method WA.disablePlayerControls is deprecated. Please use WA.controls.disablePlayerControls instead"),ze.disablePlayerControls()},restorePlayerControls(){console.warn("Method WA.restorePlayerControls is deprecated. Please use WA.controls.restorePlayerControls instead"),ze.restorePlayerControls()},displayBubble(){console.warn("Method WA.displayBubble is deprecated. Please use WA.ui.displayBubble instead"),je.displayBubble()},removeBubble(){console.warn("Method WA.removeBubble is deprecated. Please use WA.ui.removeBubble instead"),je.removeBubble()},openTab(r){console.warn("Method WA.openTab is deprecated. Please use WA.nav.openTab instead"),F.openTab(r)},loadSound(r){return console.warn("Method WA.loadSound is deprecated. Please use WA.sound.loadSound instead"),Tt.loadSound(r)},goToPage(r){console.warn("Method WA.goToPage is deprecated. Please use WA.nav.goToPage instead"),F.goToPage(r)},goToRoom(r){console.warn("Method WA.goToRoom is deprecated. Please use WA.nav.goToRoom instead"),F.goToRoom(r)},openCoWebSite(r,e=!1,t=""){return console.warn("Method WA.openCoWebSite is deprecated. Please use WA.nav.openCoWebSite instead"),F.openCoWebSite(r,e,t)},closeCoWebSite(){return console.warn("Method WA.closeCoWebSite is deprecated. Please use WA.nav.closeCoWebSite instead"),F.closeCoWebSite()},openPopup(r,e,t){return console.warn("Method WA.openPopup is deprecated. Please use WA.ui.openPopup instead"),je.openPopup(r,e,t)},onChatMessage(r){console.warn("Method WA.onChatMessage is deprecated. Please use WA.chat.onChatMessage instead"),Ve.onChatMessage(r)},onEnterZone(r,e){console.warn("Method WA.onEnterZone is deprecated. Please use WA.room.onEnterZone instead"),Ge.onEnterZone(r,e)},onLeaveZone(r,e){console.warn("Method WA.onLeaveZone is deprecated. Please use WA.room.onLeaveZone instead"),Ge.onLeaveZone(r,e)}};window.WA=ns;window.addEventListener("message",r=>{if(r.source!==window.parent)return;const e=r.data;if(dn(e)){const t=e.id,n=e.error,a=ae.get(t);if(a===void 0)throw new Error("In Iframe API, got an error answer for a question that we have no track of.");a.reject(new Error(n)),ae.delete(t)}else if(ln(e)){const t=e.id,n=e.data,a=ae.get(t);if(a===void 0)throw new Error("In Iframe API, got an answer for a question that we have no track of.");a.resolve(n),ae.delete(t)}else if(un(e)){const t=e.data,n=rt[e.type];(n==null?void 0:n.typeChecker.safeParse(t).success)&&(n==null||n.callback(t))}});
